0. Clone the devel/ branch of aeneas

1. Copy espeak_x86.dll, msvcr110.dll, portaudio_x86.dll into the aeneas/aeneas/ (where the .c source files are)

NOTE: to do a quick test on Windows, I downloaded these three files from https://github.com/fredvs/sak/tree/master/sak_dll/sakit_dll/libwin32/ , but I advise that you get the source code of both PortAudio and eSpeak, and compile the DLLs yourself, if you intend to proceed with deploying them within your installer.

2. Rename "espeak_x86.dll" into "espeak.dll"

3. Open the MSVC shell

4. SET DISTUTILS_USE_SDK=1

5. SET MSSdk=1

6. Copy espeak.dll into a temp directory foo

7. cd foo

8. Run:

dumpbin /exports espeak.dll

9. create a new plain text file "espeak.def", containing "EXPORTS" as the first line, and then the names (only the names!) of the functions, one per line, as printed by the previous command. For details, see: https://adrianhenke.wordpress.com/2008/12/05/create-lib-file-from-dll/

10. Run:

lib /def:espeak.def /out:espeak.lib

11. copy espeak.lib into $PYTHON_DIR\libs\

NOTE: unless I am missing something, it appears that steps 6-11 are necessary for the compilation of cew to succeed. Having the espeak.lib in the same directory of espeak.dll (and of cew.c) is not enough. It seems strange to me, although I have not investigated this issue in depth. If you find a workaround making steps 6-11 unnecessary, let me know, I am curious. Maybe doing a global install (python setup.py install) will do the trick.

12. cd aeneas/

13. python cew_setup.py build_ext --inplace

If it compiles without errors, you are good to go.

If you want to test the compiled cew module, run (from the aeneas root dir, as usual):

python -m aeneas.tools.synthesize_text en "This is a test|with two lines" list -v output/test.wav

The log should say "Synthesizing using C extension... done" and the output/test.wav should sound OK.

=== === ===

For distribution purposes, I guess you will only need to provide the DLL files and the compiled file cew.pyd (and copy the espeak.lib in the $PYTHON_DIR\libs\ directory, if it turns out is really necessary).

If you intend to proceed, let me know, as modifications to aeneas/setup.py will be required.




